# RIME è¾“å…¥æ³•é…ç½®æ–‡ä»¶ - çº¯äº”ç¬”æ–¹æ¡ˆ
# encoding: utf-8
# ä½œè€…: ç©ºå±±æ˜æœˆ
# æ—¥æœŸ: 2024-05-27

schema:
  schema_id: wubi              # æ–¹æ¡ˆæ ‡è¯†ç¬¦ï¼Œå”¯ä¸€ ID
  name: "çº¯äº”ç¬”"               # æ–¹æ¡ˆæ˜¾ç¤ºåç§°
  version: "2.1"               # ç‰ˆæœ¬å·
  icon: icons/CN.ico           # ä¸­æ–‡çŠ¶æ€å›¾æ ‡
  ascii_icon: icons/EN.ico     # è‹±æ–‡çŠ¶æ€å›¾æ ‡
  full_icon: icons/full.ico    # å…¨è§’çŠ¶æ€å›¾æ ‡
  half_icon: icons/half.ico    # åŠè§’çŠ¶æ€å›¾æ ‡
  author:
    - å‘æ˜äºº ç‹æ°¸æ°‘             # äº”ç¬”è¾“å…¥æ³•å‘æ˜äºº
  description: |
    æ•² z é”®è¿›å…¥æ‹¼éŸ³åæŸ¥          # æ–¹æ¡ˆæè¿°ï¼Œæ”¯æŒå¤šè¡Œ
  dependencies:
    - wb_spelling               # ä¾èµ–çš„æ‹¼å†™æ£€æŸ¥æ¨¡å—

# è¾“å…¥æ³•åˆ‡æ¢å¼€å…³é…ç½®
switches:
  - name: show_es              # æ˜¾ç¤º/éšè—è¡¨æƒ…ç¬¦å·
    reset: 0                   # é‡ç½®å€¼ (0=éšè—, 1=æ˜¾ç¤º)
    states: [ğŸ’€, ğŸ˜„]            # çŠ¶æ€å›¾æ ‡
  - name: ascii_mode           # ä¸­è‹±æ–‡è¾“å…¥æ¨¡å¼åˆ‡æ¢
    reset: 1                   # é»˜è®¤è‹±æ–‡æ¨¡å¼
    states: [ä¸­, è‹±]            # çŠ¶æ€æ˜¾ç¤º
  - name: zh_trad              # ç®€ç¹ä½“è½¬æ¢
    reset: 0                   # é»˜è®¤ç®€ä½“
    states: [ç®€, ç¹]
  - name: new_spelling         # æ–°æ‹¼å†™æ£€æŸ¥
    reset: 1                   # é»˜è®¤å¼€å¯
    states: [éš, æ˜¾]
  - name: GB2312               # å­—ç¬¦é›†é™åˆ¶
    reset: 0                   # é»˜è®¤æ‰©å±•å­—ç¬¦é›†
    states: [æ‰©, å¸¸]            # æ‰©å±• vs å¸¸ç”¨
  - name: new_hide_pinyin      # éšè—æ‹¼éŸ³æç¤º
    reset: 1                   # é»˜è®¤æ˜¾ç¤ºæ‹¼éŸ³
    states: [éŸ³, å“‘]
  - name: single_char          # å•å­—è¾“å…¥æ¨¡å¼
    reset: 0                   # é»˜è®¤è¯ç»„æ¨¡å¼
    states: [è¯, å•]
  - name: ascii_punct          # ä¸­è‹±æ–‡æ ‡ç‚¹åˆ‡æ¢
    reset: 0                   # é»˜è®¤ä¸­æ–‡æ ‡ç‚¹
    states: [ã€‚ï¼Œ, ï¼ï¼Œ]        # ä¸­æ–‡ vs è‹±æ–‡æ ‡ç‚¹
  - name: full_shape           # å…¨è§’/åŠè§’åˆ‡æ¢
    reset: 0                   # é»˜è®¤åŠè§’
    states: [åŠ, å…¨]

# è¾“å…¥å¼•æ“æ ¸å¿ƒé…ç½®
engine:
  # è¿‡æ»¤å™¨ï¼šå¯¹å€™é€‰è¯è¿›è¡Œå¤„ç†
  filters:
    - lua_filter@new_spelling@spelling    # Lua æ‹¼å†™æ£€æŸ¥
    - simplifier                           # ç®€ç¹ä½“è½¬æ¢
    - simplifier@es_conversion            # Emoji è½¬æ¢
    - lua_filter@single_char              # å•å­—æ¨¡å¼è¿‡æ»¤
    - uniquifier                          # å»é‡

  # å¤„ç†å™¨ï¼šå¤„ç†é”®ç›˜è¾“å…¥
  processors:
    - ascii_composer          # ASCII ç»„åˆå™¨
    - lua_processor@submit_text_processor  # æäº¤æ–‡æœ¬å¤„ç†
    - lua_processor@switch_processor       # å¼€å…³å¤„ç†
    - recognizer              # è¯†åˆ«å™¨
    - key_binder              # æŒ‰é”®ç»‘å®š
    - speller                 # æ‹¼å†™å™¨
    - punctuator              # æ ‡ç‚¹å™¨
    - selector                # é€‰æ‹©å™¨
    - navigator               # å¯¼èˆªå™¨
    - express_editor          # å¿«é€Ÿç¼–è¾‘å™¨

  # åˆ†æ®µå™¨ï¼šå°†è¾“å…¥åˆ†æ®µå¤„ç†
  segmentors:
    - ascii_segmentor         # ASCII åˆ†æ®µ
    - matcher                 # åŒ¹é…å™¨
    - "affix_segmentor@mkst"  # è‡ªé€ è¯åˆ†æ®µ
    - abc_segmentor           # ABC åˆ†æ®µ
    - punct_segmentor         # æ ‡ç‚¹åˆ†æ®µ
    - fallback_segmentor      # å›é€€åˆ†æ®µ

  # è½¬æ¢å™¨ï¼šç”Ÿæˆå€™é€‰è¯
  translators:
    - punct_translator        # æ ‡ç‚¹è½¬æ¢
    - reverse_lookup_translator
    - table_translator        # ä¸»ç¿»è¯‘å™¨
    - "table_translator@mkst"       # è‡ªé€ è¯
    - "history_translator@history"  # å†å²è®°å½•
    - "lua_translator@time_date"    # æ—¶é—´æ—¥æœŸ

# æ‹¼å†™å™¨é…ç½®
speller:
  auto_select: false         # æ˜¯å¦è‡ªåŠ¨é€‰æ‹©
  auto_clear: max_length     # è‡ªåŠ¨æ¸…é™¤ç¼–ç 
  delimiter: "`"             # åˆ†éš”ç¬¦
  max_code_length: 4         # æœ€å¤§ç¼–ç é•¿åº¦ (äº”ç¬”)
  alphabet: ;zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA`  # å­—æ¯è¡¨
  initials: ;zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA`   # é¦–å­—æ¯
  auto_select_pattern: ^;.$|^\w{4}$  # è‡ªåŠ¨é€‰æ‹©æ¨¡å¼
  algebra: # ä¸‡èƒ½zé”®æ‹¼å†™å¤„ç†ï¼Œzç¬¦å·åŒ¹é…ä»»æ„å­—ç¬¦
    - derive/^(...).$/$1z/           # ä¸‰ç åzåŒ¹é…ä¸€ç 
    - derive/^(..).(.*)$/$1z$2/      # ä¸¤ç åzåŒ¹é…å‰©ä½™
    - derive/^(.).(.*)$/$1z$2/       # ä¸€ç åzåŒ¹é…å‰©ä½™
    # - derive/^.(.*)$/z$1/  # å¼€å¯æœ¬è¡Œå°†ä¸zé”®é‡å¤ä¸Šå±å†²çª

# ä¸»ç¿»è¯‘å™¨é…ç½®
translator:
  dictionary: wubi.extended    # è¯å…¸æ–‡ä»¶
  db_class: tabledb           # æ•°æ®åº“ç±»å‹
  initial_quality: 100000     # åˆå§‹è´¨é‡åˆ†æ•°
  enable_charset_filter: false # ç¦ç”¨å­—ç¬¦é›†è¿‡æ»¤
  enable_sentence: true       # å¼€å¯å¥å­è¾“å…¥æ¨¡å¼
  enable_user_dict: true      # å¼€å¯ç”¨æˆ·è¯å…¸
  enable_encoder: true        # å¼€å¯ç¼–ç 
  encode_commit_history: false # ä¸ç¼–ç æäº¤å†å²
  max_phrase_length: 4        # æœ€å¤§è¯ç»„é•¿åº¦
  enable_completion: true     # å¯ç”¨è¡¥å…¨
  # preedit_format:
  #   - 'xform/^([a-z]*)$/$1\tã€ˆ\U$1\Eã€‰/'  # æ³¨é‡Šæ‰æœ¬è¡Œå°†åªæ˜¾ç¤ºé”®åæç¤ºè€Œä¸æ˜¾ç¤ºè‹±æ–‡ç¼–ç æç¤º
  #   - "xlit|ABCDEFGHIJKLMNOPQRSTUVWXY|å·¥å­åˆå¤§æœˆåœŸç‹ç›®æ°´æ—¥å£ç”°å±±å·²ç«ä¹‹é‡‘ç™½æœ¨ç¦¾ç«‹å¥³äººå¹ºè¨€|"
  disable_user_dict_for_patterns:
    - "^z.*$"                 # ç¦ç”¨Zé”®çš„ç”¨æˆ·è¯å…¸

# è‡ªé€ è¯é…ç½®
mkst:
  db_class: tabledb
  dictionary: wubi.extended
  disable_user_dict_for_patterns:
    - "^z.*$"
  enable_charset_filter: false
  enable_completion: false
  enable_encoder: false
  enable_sentence: true
  enable_user_dict: false     # ç¦ç”¨ç”¨æˆ·è¯å…¸
  encode_commit_history: false
  initial_quality: 10         # æ›´ä½ä¼˜å…ˆçº§
  max_phrase_length: 4
  prefix: "`"                 # ` å‰ç¼€è§¦å‘
  tag: mkst
  tips: "ã€ˆè‡ªé€ è¯ã€‰"          # æç¤ºæ–‡å­—

# æ‹¼éŸ³åæŸ¥é…ç½® (Zé”®è§¦å‘)
reverse_lookup:
  db_class: tabledb
  dictionary: pinyin
  disable_user_dict_for_patterns:
    - "^z.*$"
  enable_charset_filter: false
  enable_completion: false
  enable_encoder: false
  enable_sentence: false
  enable_user_dict: false
  encode_commit_history: false
  initial_quality: 100000
  max_phrase_length: 4
  preedit_format:
    - "xform/([nl])v/$1Ã¼/"
    - "xform/([nl])ue/$1Ã¼e/"
    - "xform/([jqxy])v/$1u/"
  prefix: z
  tag: rvlk1
  tips: "ã€ˆæ‹¼éŸ³åæŸ¥ã€‰"

# ç®€ç¹ä½“è½¬æ¢é…ç½®
simplifier:
  opencc_config: s2t.json     # OpenCC é…ç½®æ–‡ä»¶
  option_name: zh_trad        # å¯¹åº”çš„å¼€å…³åç§°

# Lua åå‘æ•°æ®åº“é…ç½®
lua_reverse_db:
  spelling: wb_spelling
  code: wb_spelling

# è¯†åˆ«å™¨é…ç½®
recognizer:
  import_preset: default      # å¯¼å…¥é»˜è®¤é…ç½®
  patterns:
    email: "^[A-Za-z][-_.0-9A-Za-z]*@.*$"  # é‚®ç®±è¯†åˆ«
    mkst: "^[a-y]*`[a-y`]*$"  # è‡ªé€ è¯æ¨¡å¼
    punct: "^/([0-9]0?|[A-Za-z]+)$"  # æ ‡ç‚¹æ¨¡å¼
    rvlk1: "^z[a-z]*$"         # Zé”®æ‹¼éŸ³åæŸ¥æ¨¡å¼
    uppercase: "[A-Z][-_+.'0-9A-Za-z]*$"  # å¤§å†™å­—æ¯
    url: "^(www[.]|https?:|ftp[.:]|mailto:|file:).*$|^[a-z]+[.].+$"  # URLè¯†åˆ«
    helper: "^help$"          # å¸®åŠ©å‘½ä»¤
    expression: "^=.*$"       # è¡¨è¾¾å¼æ¨¡å¼

# å†å²è®°å½•é…ç½®
history:
  input: z                    # è¾“å…¥é”®
  size: 1                     # å†å²å¤§å°
  initial_quality: 1          # åˆå§‹è´¨é‡

# æŒ‰é”®ç»‘å®šé…ç½®
key_binder:
  bindings:
    # èœå•å¯¼èˆª
    - { send: Up, accept: Left, when: has_menu }      # å·¦ç®­å¤´ä¸Šç¿»é¡µ
    - { send: Down, accept: Right, when: has_menu }   # å³ç®­å¤´ä¸‹ç¿»é¡µ
    - { send: Page_Up, accept: minus, when: has_menu } # å‡å·ä¸Šç¿»é¡µ
    - { send: Page_Down, accept: equal, when: has_menu } # ç­‰å·ä¸‹ç¿»é¡µ
    - { send: Escape, accept: space, when: composing } # ESCæ¸…ç¼–ç 
    - { send: space, accept: space, when: has_menu }  # ç©ºæ ¼ç¡®è®¤

    # åŠŸèƒ½åˆ‡æ¢
    # - { toggle: zh_trad, accept: "Control+Shift+4", when: always }      # Ctrl+Shift+4 ç®€ç¹ä½“
    # - { toggle: zh_trad, accept: "Control+Shift+dollar", when: always }
    # - { toggle: zh_trad, accept: "Control+Shift+F", when: always }
    # - { toggle: new_spelling, accept: "Control+Shift+H", when: always } # Ctrl+Shift+H æ‹¼å†™æ£€æŸ¥
    # - { toggle: new_hide_pinyin, accept: "Control+Shift+J", when: always } # Ctrl+Shift+J æ‹¼éŸ³æç¤º
    # - { toggle: single_char, accept: "Control+Shift+D", when: always }  # Ctrl+Shift+D å•å­—æ¨¡å¼
    # - { toggle: GB2312, accept: "Control+Shift+U", when: always }      # Ctrl+Shift+U å­—ç¬¦é›†

    # å€™é€‰è¯é€‰æ‹©
    - { accept: semicolon, send: 2, when: has_menu }    # åˆ†å·é€‰2
    - { accept: apostrophe, send: 3, when: has_menu }   # å¼•å·é€‰3

    # å°é”®ç›˜æ˜ å°„ (ç”¨äºæ•°å­—å¤§å†™è¾“å…¥)
    - { accept: KP_0, send: 0, when: composing }
    - { accept: KP_1, send: 1, when: composing }
    - { accept: KP_2, send: 2, when: composing }
    - { accept: KP_3, send: 3, when: composing }
    - { accept: KP_4, send: 4, when: composing }
    - { accept: KP_5, send: 5, when: composing }
    - { accept: KP_6, send: 6, when: composing }
    - { accept: KP_7, send: 7, when: composing }
    - { accept: KP_8, send: 8, when: composing }
    - { accept: KP_9, send: 9, when: composing }
    - { accept: KP_Decimal, send: period, when: composing }
    - { accept: KP_Add, send: plus, when: composing }
    - { accept: KP_Subtract, send: minus, when: composing }
    - { accept: KP_Multiply, send: asterisk, when: composing }
    - { accept: KP_Divide, send: slash, when: composing }

    # # å…¨è§’åŠè§’åˆ‡æ¢
    # - { when: always, accept: Control+Alt+space, toggle: full_shape } # Ctrl+Alt+ç©ºæ ¼
    # # ä¸­è‹±æ–‡æ ‡ç‚¹åˆ‡æ¢
    # - { when: always, accept: Control+Alt+period, toggle: ascii_punct } # Ctrl+Alt+.

# æ ‡ç‚¹é…ç½®
punctuator:
  import_preset: symbols       # å¯¼å…¥ç¬¦å·é¢„è®¾

# Emoji è½¬æ¢é…ç½®
es_conversion:
  opencc_config: es.json       # OpenCC é…ç½®æ–‡ä»¶
  option_name: show_es         # å¯¹åº”å¼€å…³
  tips: none # all/none, "ã€ˆEmojiã€‰"  # æç¤ºè®¾ç½®
  inherit_comment: false       # ä¸ç»§æ‰¿æ³¨é‡Š